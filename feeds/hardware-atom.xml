<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Techman83's Blog - hardware</title><link href="http://techman83.me/" rel="alternate"></link><link href="http://techman83.me/feeds/hardware-atom.xml" rel="self"></link><id>http://techman83.me/</id><updated>2017-01-22T00:00:00+08:00</updated><entry><title>Hacking your Conference badge for Hugs &amp; Profit</title><link href="http://techman83.me/hardware/2017/01/22/hacking_hugs_profit.html" rel="alternate"></link><published>2017-01-22T00:00:00+08:00</published><updated>2017-01-22T00:00:00+08:00</updated><author><name>Leon Wright</name></author><id>tag:techman83.me,2017-01-22:/hardware/2017/01/22/hacking_hugs_profit.html</id><summary type="html">&lt;p&gt;If you didn't already know, last week was &lt;a href="http://lca2017.org"&gt;Linux Conf AU 2017&lt;/a&gt;, which is a community run Free and Open Source Software conference that is in a different A/NZ city every year. This year I'd managed to attend the &lt;a href="http://www.openhardwareconf.org/"&gt;Open Hardware MiniConf&lt;/a&gt; and was inspired to build something during …&lt;/p&gt;</summary><content type="html">&lt;p&gt;If you didn't already know, last week was &lt;a href="http://lca2017.org"&gt;Linux Conf AU 2017&lt;/a&gt;, which is a community run Free and Open Source Software conference that is in a different A/NZ city every year. This year I'd managed to attend the &lt;a href="http://www.openhardwareconf.org/"&gt;Open Hardware MiniConf&lt;/a&gt; and was inspired to build something during the conference. I'm not sure how it occurred to me to build a 'Hug Detector' into my Conference badge, but it did and after talking about it with some fellow delegates, the feedback was overwhelmingly positive.&lt;/p&gt;
&lt;p&gt;So after heading to my room early to get some sleep, I got sidetracked. Armed with an &lt;a href="https://espressif.com/en/products/hardware/esp8266ex/overview"&gt;ESP8266&lt;/a&gt; based &lt;a href="https://www.wemos.cc/product/d1-mini.html"&gt;D1 Mini&lt;/a&gt;, some sensors,a breadboard, and some wires I stayed up until 1am. Then a wild &lt;a href="https://github.com/techman83/been_hugged"&gt;GitHub repository&lt;/a&gt; occurred.&lt;/p&gt;
&lt;p&gt;&lt;blockquote class="twitter-tweet" align="center"&gt;&lt;a href="https://twitter.com/Techman_83/status/821716638235906050"&gt;Tweet of Techman_83/821716638235906050&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;I popped by the rego desk the next morning, to acquire an extra badge holder. Which was met with some initial quizzical expressions, followed by intrigue whilst handing it over. Sitting up the back of the sessions and stabbing myself several times, I managed to get something of a working concept. &lt;/p&gt;
&lt;p&gt;&lt;blockquote class="twitter-tweet" align="center"&gt;&lt;a href="https://twitter.com/johndalton/status/821918573215895552"&gt;Tweet of johndalton/821918573215895552&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;That evening I set about tidying up the wires and got it working well enough with the sensors I had on hand. However I really wanted to get the &lt;a href="http://www.freetronics.com.au/products/freepixel-addressable-rgb-led-module"&gt;Freepixels&lt;/a&gt; I'd attached to display feedback about 'Hug Quality' and was hitting a strange problem with the micro controllers memory disappearing when ever I utilised them. As it turns out there was a dev from &lt;a href="https://espressif.com/"&gt;Expressif Systems&lt;/a&gt; who was intrigued by my badge and when I mentioned my problem it was met with "Want me to take a look at the code". &lt;/p&gt;
&lt;p&gt;&lt;blockquote class="twitter-tweet" align="center"&gt;&lt;a href="https://twitter.com/Techman_83/status/822267900585123840"&gt;Tweet of Techman_83/822267900585123840&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;As it turns out the bug was in how I was iterating over the LED modules:&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;NUM_LEDS&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;leds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;CRGB&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;Red&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;leds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;maximizeBrightness&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;FastLED&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;'NUM_LEDS' is configured as '2', but arrays start at '0' in a lot of languages (including c++) so I was iterating past the end of 'leds' array and corrupting the micro controllers memory. I'd missed that entirely and as I generally work in higher level scripting languages, this kind of thing normally blows up the runtime in quite an obvious way. Below is the single character change that fixed the problem.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;NUM_LEDS&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="n"&gt;leds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;CRGB&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;Red&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;leds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="n"&gt;maximizeBrightness&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="n"&gt;FastLED&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Overall I really enjoyed working on the project. It was a fun way to make new friends and make a positive contribution to what was an exceptional LCA. Here are some extra tweets that shared the joy &amp;lt;3&lt;/p&gt;
&lt;p&gt;&lt;blockquote class="twitter-tweet" align="center"&gt;&lt;a href="https://twitter.com/r1chardj0n3s/status/821975880498974720"&gt;Tweet of r1chardj0n3s/821975880498974720&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;&lt;blockquote class="twitter-tweet" align="center"&gt;&lt;a href="https://twitter.com/vmbrasseur/status/822198988577198080"&gt;Tweet of vmbrasseur/822198988577198080&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;&lt;blockquote class="twitter-tweet" align="center"&gt;&lt;a href="https://twitter.com/The_McJones/status/822198909896257536"&gt;Tweet of The_McJones/822198909896257536&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;&lt;blockquote class="twitter-tweet" align="center"&gt;&lt;a href="https://twitter.com/johndalton/status/822219959610707969"&gt;Tweet of johndalton/822219959610707969&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;&lt;blockquote class="twitter-tweet" align="center"&gt;&lt;a href="https://twitter.com/Charcol0x89/status/822294441813622784"&gt;Tweet of Charcol0x89/822294441813622784&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;&lt;blockquote class="twitter-tweet" align="center"&gt;&lt;a href="https://twitter.com/ITProAssoc/status/822298107274821632"&gt;Tweet of ITProAssoc/822298107274821632&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;p&gt;&lt;blockquote class="twitter-tweet" align="center"&gt;&lt;a href="https://twitter.com/evildeece/status/822301398767259649"&gt;Tweet of evildeece/822301398767259649&lt;/a&gt;&lt;/blockquote&gt;&lt;/p&gt;&lt;script src="//platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;</content><category term="programming"></category><category term="arduino"></category><category term="linuxconfau"></category><category term="lca2017"></category></entry><entry><title>Automating your home with 'themachine'</title><link href="http://techman83.me/hardware/2017/01/11/automating_your_home_with_themachine.html" rel="alternate"></link><published>2017-01-11T00:00:00+08:00</published><updated>2017-01-11T00:00:00+08:00</updated><author><name>Leon Wright</name></author><id>tag:techman83.me,2017-01-11:/hardware/2017/01/11/automating_your_home_with_themachine.html</id><summary type="html">&lt;p&gt;There will be more posts to come, but for some time I have been playing around with home automation. One of the things I really wanted to do was utilise some form of machine learning to make decisions about when I wanted the Shed's Airconditioning or the wall fan turned …&lt;/p&gt;</summary><content type="html">&lt;p&gt;There will be more posts to come, but for some time I have been playing around with home automation. One of the things I really wanted to do was utilise some form of machine learning to make decisions about when I wanted the Shed's Airconditioning or the wall fan turned on. I could have utilised rules in my &lt;a href="http://www.openhab.org/"&gt;OpenHAB&lt;/a&gt; based home automation system, however I'd already gotten reasonably creative with those and wanted a challenge.&lt;/p&gt;
&lt;p&gt;I've been learning about machine learning for a while, in particular however it was this post on &lt;a href="http://stackoverflow.com/questions/30991592/support-vector-machine-in-python-using-libsvm-example-of-features"&gt;Stackoverflow&lt;/a&gt; and sentdex's &lt;a href="https://www.youtube.com/playlist?list=PLQVvvaa0QuDfKTOs3Keq_kaG2P55YRn5v"&gt;Machine Learning with Python&lt;/a&gt; playlist that really helped me find a solution that appeared to fit what I was trying to do.&lt;/p&gt;
&lt;p&gt;Using a couple of &lt;a href="http://www.freetronics.com.au/products/humidity-and-temperature-sensor-module"&gt;DHT22&lt;/a&gt; sensor modules attached to &lt;a href="https://www.wemos.cc/product/d1-mini.html"&gt;Wemos D1 Mini&lt;/a&gt;, I was readily collecting Temperature data into OpenHAB.&lt;/p&gt;
&lt;figure &gt;
  &lt;a class="fancybox" id="single_image" href="https://www.dropbox.com/s/q8z0keglyjudxfz/dht11_wemos_d1.jpg?dl=1"&gt;
    &lt;img src="https://www.dropbox.com/s/woijao1722z2qdl/dht11_wemos_d1-sml.jpg?dl=1" /&gt;
  &lt;/a&gt;
      &lt;figcaption&gt;Wemos D1 + DHT22 shown with USB Key for Scale&lt;figcaption/&gt;
&lt;/figure&gt;

&lt;p&gt;I settled on a Support Vector Machine algorithm as it seemed to best fit my dataset of "inTemperatur,inHumidity,outTemperature,outHumidity" and my decisions required being On or Off. The following video does an excellent job of explaining SVM.&lt;/p&gt;
&lt;p&gt;
&lt;iframe allowfullscreen="true" frameborder="0" height="315" src="//www.youtube.com/embed/mA5nwGoRAOo" width="560"&gt;&lt;/iframe&gt;
&lt;/p&gt;
&lt;p&gt;I ended up writing a Python script that listens for change and learn events on the &lt;a href="https://en.wikipedia.org/wiki/MQTT"&gt;MQTT&lt;/a&gt; message bus which ties my home automation system together. OpenHAB fires change events when I'm present in the shed and fires learn events when I manually turn on AC or Fan on. If 'themachine' predicts a positive result greater than 95% certaintity it will fire back to a channel that OpenHAB has a switch sitting on to receive the event.&lt;/p&gt;
&lt;p&gt;Example log of an event:&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;2017-01-11 20:53:52,721 INFO     I&amp;#39;m 97.92% sure you wanted the shedFan on. shed,26.70,58.10,21.00,81.30
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can find out more information about how to implement something similar on &lt;a href="https://github.com/techman83/habsvm-themachine"&gt;GitHub&lt;/a&gt;, it's MIT licensed so feel free to use the code how you'd like.&lt;/p&gt;
&lt;p&gt;I have to admit, the first time it came on by itself was a little weird. I was standing on a stepladder doing some terminating in my rack (yes of course I have a full height network rack in my shed), thinking that it had gotten a little warm &lt;em&gt;AC Turns on&lt;/em&gt; ... "woah". Skynet however is a long way off, well at least in my little home automation setup.&lt;/p&gt;&lt;script src="//platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;</content><category term="homeautomation"></category><category term="machinelearning"></category><category term="programming"></category><category term="python"></category></entry></feed>